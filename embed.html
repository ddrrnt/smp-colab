<script>
    // Add this function to decompress the OPML string
    function decompressString(string) {
        const decompress = (string) => {
            return string.replace(/<o/g, '<outline')
                         .replace(/<\/o>/g, '</outline>')
                         .replace(/t="/g, 'text="');
        };
        return decompress(string);
    }

    // Update the loadMindmap function
    function loadMindmap() {
        const params = new URLSearchParams(window.location.search);
        const encodedOPML = params.get('d');
        if (encodedOPML) {
            const compressedOPML = decodeURIComponent(atob(encodedOPML));
            const opmlString = decompressString(compressedOPML);
            const data = parseOPML(opmlString);
            renderMindmap(document.getElementById('mindmap-container'), data);
        }
    }

    // The rest of your embed.html script remains the same
</script>
